<!DOCTYPE html>
<html>
<body>

<canvas id="myCanvas" width="1600" height="5000" style="border:1px solid #d3d3d3;">
    Your browser does not support the HTML5 canvas tag.</canvas>

<script>

    var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");

    ctx.translate( 2500/2, 1000/2);
    ctx.rotate(Math.PI/2);

    ctx.beginPath();
    //ctx.moveTo(0, 0);
    //ctx.lineTo(300, 150);
    ctx.stroke();

    //var map = new Array([1], [1, 1, 1], [1, 1, 0, 3]);
    //var map = new Array([1], [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1], [0,8,8,0,11,25,25,25,25,25,25,25,0,0,0,0,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32], [0,0,0,4,4,6,7,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] );

    /* block.vn */
    /*var map = new Array(
    [1],
    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    [0, 0, 0, 0, 0, 0, 0, 8, 8, 0, 0, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 25, 25, 25, 25, 25, 25, 0, 0, 0, 0, 0, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 32, 32, 32, 32, 32, 32, 32],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 4, 0, 6, 7, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
    */

    /*var map = new Array(
        [1],
        [1, 1, 1, 1],
        [1, 0, 3, 3, 0]
    ); */

    var map = new Array([1 ],
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ],
[0, 0, 0, 4, 4, 5, 6, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 10, 11, 12, 0, 0, 0, 0, 17, 17, 18, 18, 18, 18, 18, 19, 20, 20, 20, 21, 21, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 25, 26, 26, 26, 27, 27, 27, 28, 28, 28, 29, 29, 29, 29, 29, 29, 30, 0, 0, 0, 0, 0, 0, 0 ],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 7, 7, 7, 7, 7, 8, 8, 9, 9, 9, 10, 10, 10, 11, 11, 12, 12, 12, 13, 13, 14, 14, 15, 15, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 19, 19, 20, 20, 20, 21, 21, 22, 22, 23, 23, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 41, 41, 42, 0, 44, 45, 45, 45, 46, 46, 47, 47, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 49, 49, 49, 50, 50, 51, 52, 52, 53, 53, 54, 54, 55, 55, 0, 57, 57, 57, 58, 0, 0, 61, 61, 62, 62, 0, 64, 65, 0, 67, 67, 67, 68, 68, 68, 68, 68, 0, 70, 70, 71, 72, 73, 74, 0, 0, 0, 0, 0, 0, 0, 0],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 4, 0, 6, 0, 8, 0, 10, 11, 0, 13, 14, 0, 16, 0, 18, 19, 0, 21, 0, 23, 0, 25, 0, 27, 28, 0, 30, 31, 32, 33, 34, 35, 36, 0, 38, 0, 0, 0, 42, 43, 0, 45, 45, 45, 0, 47, 0, 49, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 51, 52, 0, 0, 0, 0, 0, 57, 0, 59, 0, 61, 0, 0, 64, 65, 66, 67, 68, 69, 70, 71, 0, 73, 74, 0, 76, 0, 0, 79, 0, 81, 0, 83, 0, 85, 0, 0, 87, 88, 0, 0, 0, 0, 91, 0, 93, 0, 0, 0, 0, 0, 97, 98, 0, 100, 101, 102, 103, 0, 0, 105, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29, 29, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])


    var boxW = 20;
    var boxH = 100;

    var halfBoxH = boxH / 2;
    var halfBoxW = boxW / 2;

    var nfloor = map.length;

    function buildTreeMap(floor, height, coord) {

        var rect = new Array();

        if (floor == nfloor - 1) {
            var bgDir = 10;

            //alert(map[floor].length);

            for (var i = 0; i < map[floor].length; i++) {
                if (map[floor][i] > 0)
                {

                    ctx.rect(bgDir, height, boxW, boxH);
                    ctx.stroke();


                }
                rect.push(bgDir);
                bgDir = bgDir + boxW + 10;
            }


        }
        else {

            for (var i = 0; i < map[floor].length; i++) {
                if (map[floor][i] > 0) {
                    ctx.rect(coord[i], height, boxW, boxH);
                    ctx.stroke();
                }
                rect.push(coord[i]);
            }
        }


        // draw linked lines
        if (floor == 0) return;
        var coord = new Array();
        var bgSeg = 0;
        height = height + boxH;

        for (var i = 0; i < map[floor].length; i++) {
            if (i == map[floor].length - 1 || map[floor][i] == 0 || (i < map[floor].length - 1 && map[floor][i] != map[floor][i + 1])) {

                var endSeg = i;

                if (map[floor][i] != 0) {
               // if (true) {
                    for (var j = bgSeg; j <= endSeg; j++) {
                        ctx.moveTo(rect[j] + halfBoxW, height);
                        ctx.lineTo(rect[j] + halfBoxW, height + 25);
                    }

                    /*ctx.moveTo(rect[bgSeg] + halfBoxW, height);
                    ctx.lineTo(rect[bgSeg] + halfBoxW, height + 25);

                    ctx.moveTo(rect[endSeg] + halfBoxW, height);
                    ctx.lineTo(rect[endSeg] + halfBoxW, height + 25); */

                    // line to begin to end

                    ctx.moveTo(rect[bgSeg] + halfBoxW, height + 25);
                    ctx.lineTo(rect[endSeg] + halfBoxW, height + 25);

                    // to parent

                    var mid = rect[bgSeg] + halfBoxW + (rect[endSeg] - rect[bgSeg]) / 2
                    ctx.moveTo(mid, height + 25);
                    ctx.lineTo(mid, height + 50);

                    ctx.stroke();
                }

                coord.push(rect[bgSeg] + (rect[endSeg] - rect[bgSeg]) / 2);

                //console.log("begin " + bgSeg);
                //console.log("end " + endSeg);

                bgSeg = i + 1;
            }
        }


        buildTreeMap(floor - 1, height + 50, coord);
    }

    buildTreeMap(nfloor - 1, 10, []);



</script>

<body>

</body>
</html>